# Use an official Ubuntu as a parent image
FROM ubuntu:20.04

# Set environment variables to avoid prompts during installation
ENV DEBIAN_FRONTEND=noninteractive

# Install dependencies
RUN apt-get update && \
    apt-get install -y \
    openjdk-17-jdk \
    wget \
    unzip \
    curl \
    git \
    build-essential

# Install Node.js and npm
RUN curl -fsSL https://deb.nodesource.com/setup_20.x | bash - && \
    apt-get install -y nodejs

# Install pnpm
RUN npm install -g pnpm

# Set JAVA_HOME environment variable
ENV JAVA_HOME=/usr/lib/jvm/java-17-openjdk-amd64

# Copy the project files into the Docker image
WORKDIR /app
COPY . .

# Install project dependencies
RUN ./scripts/install-dependencies.sh

# Make the script executable
RUN chmod +x ./scripts/run-android.sh

# Set the entry point to the run-android.sh script
ENTRYPOINT ["./scripts/run-android.sh"]
